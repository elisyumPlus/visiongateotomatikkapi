<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8"><title>Admin Panel</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
</head>
<body class="p-4 bg-light">
    <div class="container-fluid">
        <h3 class="fw-bold mb-4">VİSİON GATE | Admin</h3>
        <div class="row">
            <div class="col-md-3">
                <div class="card p-3 shadow-sm">
                    <h6>Duyuru Yönetimi</h6>
                    <textarea id="m" class="form-control mb-2"></textarea>
                    <label><input type="checkbox" id="ak"> Yayına Al</label>
                    <button onclick="upd()" class="btn btn-dark w-100 mt-2">GÜNCELLE</button>
                </div>
            </div>
            <div class="col-md-9">
                <div class="card p-3 mb-4 shadow-sm">
                    <h6>Gelen Teklifler</h6>
                    <table class="table table-sm small">
                        <thead><tr><th>Ad</th><th>Tel</th><th>Hizmet</th><th>Tarih</th><th>X</th></tr></thead>
                        <tbody id="tL"></tbody>
                    </table>
                </div>
                <div class="card p-3 shadow-sm">
                    <h6>Arıza Kayıtları</h6>
                    <table class="table table-sm small text-danger">
                        <tbody id="aL"></tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
<script>
    const firebaseConfig = {
        apiKey: "AIzaSyDXTBYHb9kxgb37-H-NM2dn1ESvVy0xg88",
        authDomain: "visiongateotokapi.firebaseapp.com",
        projectId: "visiongateotokapi",
        storageBucket: "visiongateotokapi.firebasestorage.app",
        messagingSenderId: "913114045124",
        appId: "1:913114045124:web:2ff87d9e0a9c3d062b8791"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    function upd() {
        db.collection("ayarlar").doc("duyuru").set({
            mesaj: document.getElementById("m").value, aktif: document.getElementById("ak").checked
        }).then(() => alert("Tamamdır!"));
    }

    db.collection("teklifler").orderBy("tarih","desc").onSnapshot(ss => {
        let h = "";
        ss.forEach(doc => {
            const d = doc.data();
            h += `<tr><td>${d.ad}</td><td>${d.tel}</td><td>${d.hizmet}</td><td>${d.tarih}</td>
            <td><button onclick="del('teklifler','${doc.id}')" class="btn btn-danger btn-sm">X</button></td></tr>`;
        });
        document.getElementById("tL").innerHTML = h;
    });

    db.collection("arizalar").orderBy("tarih","desc").onSnapshot(ss => {
        let h = "";
        ss.forEach(doc => {
            const d = doc.data();
            h += `<tr><td>${d.ad}</td><td>${d.tel}</td><td>${d.not}</td>
            <td><button onclick="del('arizalar','${doc.id}')" class="btn btn-danger btn-sm">X</button></td></tr>`;
        });
        document.getElementById("aL").innerHTML = h;
    });

    function del(c, i) { if(confirm("Silinsin mi?")) db.collection(c).doc(i).delete(); }
</script>
</body>
</html>
